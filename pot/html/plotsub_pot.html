
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>plotsub_pot</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-28"><meta name="DC.source" content="plotsub_pot.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [k_pot_lf,sigma2_k_pot_lf, k_pot_nl,sigma2_k_pot_nl , k_eq, sigma2_k_eq]=plotsub_pot(filename, positioninthefig1, positionintefig2, title1, T, P, subssample)
</pre><pre class="codeinput">load(filename);
disp(filename);
kb=1.38e-23;

<span class="comment">%blue color</span>
col1=[73/255,4/255,10/255];

<span class="comment">%yellow</span>
col2=[241/255,185/255,14/255];
<span class="comment">%gray color for experimental data</span>


<span class="comment">%colbar=[4/255,45/255,73/255];</span>
	colbar=[7/255, 79/255, 129/255];
<span class="comment">% xwi = 400;    % width of the plot square</span>
<span class="comment">% bx1 = 80;     % extra space at the left</span>
<span class="comment">% bx2 = 20;     % extra space at the right</span>
<span class="comment">%</span>
<span class="comment">% Xpix = 3.5*xwi+3*bx1+3*bx2;  % total</span>
<span class="comment">%</span>
<span class="comment">% ywi = 300;    % length riquadro con funzione</span>
<span class="comment">% by1 = 60;     % extra space below</span>
<span class="comment">% by2 = 30;     % extra space up</span>
<span class="comment">% Ypix = 2*by1+2*ywi+3*by2;  % larghezza figura in pixel</span>

P=50;

<span class="comment">%number of bins of the histogram, if not set default is 50</span>
<span class="comment">%linear fit</span>
[k_pot_lf, sigma2_k_pot_lf, x_alpha_lf, mrho_lf, sigma2_rho_lf, mU_lf, sigma2_U_lf, rho0_lf, x_eq_lf, U_0_exp_lf]=pot_lfit(x,T,P);
<span class="comment">%non-linear fit`</span>
[k_pot_nl, sigma2_k_pot_nl, x_alpha_nl, mrho_nl, sigma2_rho_nl, mU_nl, sigma2_U_nl, rho0_nl, x_eq_nl,  U_0_exp_nl]=pot_nlfit(x,T,P);

subsample=1;

<span class="comment">%number of bins of the histogram, if not set default is 50</span>
<span class="comment">%linear fit</span>
[k_eq,sigma2_k_eq]=eq1d(x(1:subsample:1000000,:),T,0e-9);

axes( <span class="string">'Position'</span>,positioninthefig1);  <span class="comment">% fa in modo di centrare il riquadro degli assi nella posizione voluta</span>
<span class="comment">% disp('Check that the probability distribiution is normalized')</span>
<span class="comment">% disp('Integral of the experimental distribuitions')</span>
<span class="comment">% disp('Linear fitting')</span>
<span class="comment">% disp(sum(mrho_lf*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));</span>
<span class="comment">% disp('Non-linear fitting')</span>
<span class="comment">% disp(sum(mrho_lf*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));</span>

a0=(max(mrho_lf))^2;
rhomodel_eq=rho0_lf*exp(-k_eq/(2*kb*T)*(x_alpha_lf).^2);
rhomodel_lf=rho0_lf*exp(-k_pot_lf/(2*kb*T)*(x_alpha_lf-x_eq_lf).^2);
rhomodel_nl=rho0_nl*exp(-k_pot_nl/(2*kb*T)*(x_alpha_nl-x_eq_nl).^2);
<span class="comment">% disp('Integral of the fitted probability distributions')</span>
<span class="comment">% disp('Linear fitting')</span>
<span class="comment">% disp(sum(rhomodel_lf*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));</span>
<span class="comment">% disp('Non-linear fitting')</span>
<span class="comment">% disp(sum(rhomodel_nl*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));</span>
cyan=[0/255,128/255,128/255];
scatter((x_alpha_lf)*1e6+0.0005, rhomodel_eq*1e-6,<span class="string">'SizeData'</span>,200,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'white'</span>, <span class="string">'MarkerFaceColor'</span>,color2rgb(<span class="string">'white_cyan'</span>),<span class="string">'MarkerFaceAlpha'</span>,0.9,<span class="string">'DisplayName'</span>,  <span class="string">'Equipartition'</span>);
hold <span class="string">on</span>

plot(x_alpha_lf*1e6, rhomodel_lf*1e-6, <span class="string">'LineWidth'</span>,4.5,<span class="string">'Color'</span>,col2, <span class="string">'DisplayName'</span>,  <span class="string">'Linear fit'</span>);

cyan=[0/255,128/255,128/255];
plot(x_alpha_nl*1e6, rhomodel_nl*1e-6,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,3,<span class="string">'Color'</span>,color2rgb(<span class="string">'deep_purple'</span>), <span class="string">'DisplayName'</span>, <span class="string">'Non-linear fit'</span>)

errorbar(x_alpha_lf*1e6,  mrho_lf*1e-6, 1e-6*abs(sigma2_rho_lf),<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,7 ,<span class="string">'LineWidth'</span>, 1.5,<span class="string">'Color'</span>,colbar,<span class="string">'DisplayName'</span>, <span class="string">'Experimental'</span>);



box <span class="string">on</span>
<span class="comment">%xticks((-0.5:0.1:0.5)*1e-7);</span>
xlim([-0.070 0.070]);
ylim([-1 50])
set(gca,<span class="string">'TickLabelInterpreter'</span>,<span class="string">'tex'</span>, <span class="string">'linewidth'</span>,1.5,<span class="string">'FontSize'</span>,25);
xlabel(<span class="string">'x (&micro; m)'</span>,<span class="string">'Interpreter'</span>,<span class="string">'tex'</span>, <span class="string">'FontSize'</span>,30)
<span class="comment">%xlabel(['c_{O2} [',char(181),'mol/l]'],'Interpreter','tex')</span>
ylabel([<span class="string">'\rho (\mu m^-1)'</span>],<span class="string">'Interpreter'</span>,<span class="string">'tex'</span>, <span class="string">'FontSize'</span>,30)
hold <span class="string">off</span>
legend(<span class="string">'FontSize'</span>,25)

<span class="comment">%second figure, Energy potential distribution, exp I</span>
axes(<span class="string">'Position'</span>,positionintefig2);
hold <span class="string">on</span>;

<span class="comment">%scatter(x_alpha_lf*1e6, -log(mrho_lf)-U_0_exp,80,'o', 'markerfacecolor','colbar', 'markeredgecolor', colbar , 'DisplayName', 'Experimental values of potential energy')</span>
<span class="comment">%errorbar(x_alpha_lf*1e6,  -log(mrho_lf)-U_0_exp_nl, -log(1e-6*abs(sigma2_rho_lf)), 'Color', colbar,  'DisplayName', 'Experimental values of potential energy');</span>
<span class="comment">%sigma2_U_nl</span>


U_model_lf=-(log(rhomodel_lf));
U_model_nl=-(log(rhomodel_nl));


U_model_eq=-(log(rhomodel_eq));

scatter((x_alpha_lf)*1e6+0.0005,U_model_eq-U_0_exp_lf, <span class="string">'SizeData'</span>,200,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'white'</span>,<span class="string">'MarkerFaceColor'</span>,color2rgb(<span class="string">'white_cyan'</span>),<span class="string">'MarkerFaceAlpha'</span>,0.9, <span class="string">'DisplayName'</span>,  <span class="string">'Equipartition'</span>)
hold <span class="string">on</span>
plot(x_alpha_lf*1e6,U_model_lf-U_0_exp_lf, <span class="string">'LineWidth'</span>,4.5,<span class="string">'Color'</span>,col2,<span class="string">'DisplayName'</span>,  <span class="string">'Linear fit'</span>)

plot(x_alpha_nl*1e6,U_model_nl-U_0_exp_nl, <span class="string">'--'</span>, <span class="string">'LineWidth'</span>,3,<span class="string">'Color'</span>,color2rgb(<span class="string">'deep_purple'</span>), <span class="string">'DisplayName'</span>, <span class="string">'Non-linear fit'</span>)

<span class="comment">%plot(x_alpha_lf*1e6,U_model_eq-U_0_exp_lf,'-.', 'LineWidth',2,'Color','black','DisplayName',  'Equipotential')</span>

box <span class="string">on</span>

<span class="comment">%xticks((-0.5:0.1:0.5)*1e-7);</span>

errorbar(x_alpha_lf*1e6,  -log(mrho_lf)-U_0_exp_nl, sigma2_U_lf/(kb*T), <span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,7,<span class="string">'LineWidth'</span>, 1.5, <span class="string">'Color'</span>, colbar,  <span class="string">'DisplayName'</span>, <span class="string">'Experimental values of potential energy'</span>);

xlim([-0.070 0.070]);
<span class="comment">%xlim([x_alpha_lf(1)*1e6 x_alpha_lf(end)*1e6]);</span>
set(gca,<span class="string">'TickLabelInterpreter'</span>,<span class="string">'tex'</span>, <span class="string">'linewidth'</span>,1.5, <span class="string">'FontSize'</span>,25);
str = [<span class="string">'$ x ($'</span>  <span class="string">'\mu'</span> <span class="string">'$m)$'</span>];
</pre><pre class="codeoutput error">Not enough input arguments.

Error in plotsub_pot (line 2)
load(filename);
</pre><p><img src="plotsub_pot_eq15682195134482745114.png" alt="$x^2+e^{\pi i}$" style="width:36px;height:11px;"></p><p><img src="plotsub_pot_eq17467035999183504765.png" alt="$$e^{\pi i} + 1 = 0$$" style="width:52px;height:11px;"></p><pre class="codeinput">xlabel(str,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>, <span class="string">'FontSize'</span>,30)
</pre><p><img src="plotsub_pot_eq17467035999183504765.png" alt="$$e^{\pi i} + 1 = 0$$" style="width:52px;height:11px;"></p><pre class="codeinput"><span class="comment">%</span>
ylabel(<span class="string">'$U(k_{\rm B} T)$'</span>,<span class="string">'Interpreter'</span>,<span class="string">'Latex'</span>,<span class="string">'FontSize'</span>,30)
ylim([-0.5, 10])

hold <span class="string">off</span>
 set(gca,<span class="string">'DefaultTextFontname'</span>, <span class="string">'TimesNewRoman'</span>)
   set(gca,<span class="string">'DefaultAxesFontName'</span>,<span class="string">'TimesNewRoman'</span>)
   legend(<span class="string">'FontSize'</span>,25)
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
function [k_pot_lf,sigma2_k_pot_lf, k_pot_nl,sigma2_k_pot_nl , k_eq, sigma2_k_eq]=plotsub_pot(filename, positioninthefig1, positionintefig2, title1, T, P, subssample)
load(filename);
disp(filename);
kb=1.38e-23;

%blue color
col1=[73/255,4/255,10/255];
	
%yellow
col2=[241/255,185/255,14/255];
%gray color for experimental data
	

%colbar=[4/255,45/255,73/255];
	colbar=[7/255, 79/255, 129/255];
% xwi = 400;    % width of the plot square
% bx1 = 80;     % extra space at the left
% bx2 = 20;     % extra space at the right
% 
% Xpix = 3.5*xwi+3*bx1+3*bx2;  % total
% 
% ywi = 300;    % length riquadro con funzione
% by1 = 60;     % extra space below
% by2 = 30;     % extra space up
% Ypix = 2*by1+2*ywi+3*by2;  % larghezza figura in pixel

P=50;

%number of bins of the histogram, if not set default is 50
%linear fit
[k_pot_lf, sigma2_k_pot_lf, x_alpha_lf, mrho_lf, sigma2_rho_lf, mU_lf, sigma2_U_lf, rho0_lf, x_eq_lf, U_0_exp_lf]=pot_lfit(x,T,P);
%non-linear fit`
[k_pot_nl, sigma2_k_pot_nl, x_alpha_nl, mrho_nl, sigma2_rho_nl, mU_nl, sigma2_U_nl, rho0_nl, x_eq_nl,  U_0_exp_nl]=pot_nlfit(x,T,P);

subsample=1;

%number of bins of the histogram, if not set default is 50
%linear fit
[k_eq,sigma2_k_eq]=eq1d(x(1:subsample:1000000,:),T,0e-9);

axes( 'Position',positioninthefig1);  % fa in modo di centrare il riquadro degli assi nella posizione voluta
% disp('Check that the probability distribiution is normalized')
% disp('Integral of the experimental distribuitions')
% disp('Linear fitting')
% disp(sum(mrho_lf*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));
% disp('Non-linear fitting')
% disp(sum(mrho_lf*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));

a0=(max(mrho_lf))^2;
rhomodel_eq=rho0_lf*exp(-k_eq/(2*kb*T)*(x_alpha_lf).^2);
rhomodel_lf=rho0_lf*exp(-k_pot_lf/(2*kb*T)*(x_alpha_lf-x_eq_lf).^2);
rhomodel_nl=rho0_nl*exp(-k_pot_nl/(2*kb*T)*(x_alpha_nl-x_eq_nl).^2);
% disp('Integral of the fitted probability distributions')
% disp('Linear fitting')
% disp(sum(rhomodel_lf*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));
% disp('Non-linear fitting')
% disp(sum(rhomodel_nl*1e-6)*((x_alpha_lf(2)-x_alpha_lf(1))*1e6));
cyan=[0/255,128/255,128/255];
scatter((x_alpha_lf)*1e6+0.0005, rhomodel_eq*1e-6,'SizeData',200,'MarkerEdgeColor','white', 'MarkerFaceColor',color2rgb('white_cyan'),'MarkerFaceAlpha',0.9,'DisplayName',  'Equipartition');
hold on

plot(x_alpha_lf*1e6, rhomodel_lf*1e-6, 'LineWidth',4.5,'Color',col2, 'DisplayName',  'Linear fit');

cyan=[0/255,128/255,128/255];
plot(x_alpha_nl*1e6, rhomodel_nl*1e-6,'REPLACE_WITH_DASH_DASH','LineWidth',3,'Color',color2rgb('deep_purple'), 'DisplayName', 'Non-linear fit')

errorbar(x_alpha_lf*1e6,  mrho_lf*1e-6, 1e-6*abs(sigma2_rho_lf),'.','MarkerSize',7 ,'LineWidth', 1.5,'Color',colbar,'DisplayName', 'Experimental');



box on
%xticks((-0.5:0.1:0.5)*1e-7);
xlim([-0.070 0.070]);
ylim([-1 50])
set(gca,'TickLabelInterpreter','tex', 'linewidth',1.5,'FontSize',25);
xlabel('x (Âµ m)','Interpreter','tex', 'FontSize',30)
%xlabel(['c_{O2} [',char(181),'mol/l]'],'Interpreter','tex')
ylabel(['\rho (\mu m^-1)'],'Interpreter','tex', 'FontSize',30)
hold off
legend('FontSize',25)

%second figure, Energy potential distribution, exp I
axes('Position',positionintefig2);  
hold on;

%scatter(x_alpha_lf*1e6, -log(mrho_lf)-U_0_exp,80,'o', 'markerfacecolor','colbar', 'markeredgecolor', colbar , 'DisplayName', 'Experimental values of potential energy')
%errorbar(x_alpha_lf*1e6,  -log(mrho_lf)-U_0_exp_nl, -log(1e-6*abs(sigma2_rho_lf)), 'Color', colbar,  'DisplayName', 'Experimental values of potential energy');
%sigma2_U_nl


U_model_lf=-(log(rhomodel_lf));
U_model_nl=-(log(rhomodel_nl));


U_model_eq=-(log(rhomodel_eq));

scatter((x_alpha_lf)*1e6+0.0005,U_model_eq-U_0_exp_lf, 'SizeData',200,'MarkerEdgeColor','white','MarkerFaceColor',color2rgb('white_cyan'),'MarkerFaceAlpha',0.9, 'DisplayName',  'Equipartition')
hold on
plot(x_alpha_lf*1e6,U_model_lf-U_0_exp_lf, 'LineWidth',4.5,'Color',col2,'DisplayName',  'Linear fit')

plot(x_alpha_nl*1e6,U_model_nl-U_0_exp_nl, 'REPLACE_WITH_DASH_DASH', 'LineWidth',3,'Color',color2rgb('deep_purple'), 'DisplayName', 'Non-linear fit')

%plot(x_alpha_lf*1e6,U_model_eq-U_0_exp_lf,'-.', 'LineWidth',2,'Color','black','DisplayName',  'Equipotential')

box on

%xticks((-0.5:0.1:0.5)*1e-7);

errorbar(x_alpha_lf*1e6,  -log(mrho_lf)-U_0_exp_nl, sigma2_U_lf/(kb*T), '.','MarkerSize',7,'LineWidth', 1.5, 'Color', colbar,  'DisplayName', 'Experimental values of potential energy');

xlim([-0.070 0.070]);
%xlim([x_alpha_lf(1)*1e6 x_alpha_lf(end)*1e6]);
set(gca,'TickLabelInterpreter','tex', 'linewidth',1.5, 'FontSize',25);
str = ['$ x ($'  '\mu' '$m)$'];
%%
% $x^2+e^{\pi i}$
% 
% $$e^{\pi i} + 1 = 0$$
% 
xlabel(str,'Interpreter','latex', 'FontSize',30)
%%
% 
% $$e^{\pi i} + 1 = 0$$
% 
%%
% 
%
% 
%%
% 
% 
% 

% 
ylabel('$U(k_{\rm B} T)$','Interpreter','Latex','FontSize',30)
ylim([-0.5, 10])

hold off
 set(gca,'DefaultTextFontname', 'TimesNewRoman')
   set(gca,'DefaultAxesFontName','TimesNewRoman')
   legend('FontSize',25)
end
##### SOURCE END #####
--></body></html>